<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the package • SparseSignatures</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the package">
<meta property="og:description" content="SparseSignatures">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SparseSignatures</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/2_using_the_package.html">Using the package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/danro9685/SparseSignatures/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="2_using_the_package_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danro9685/SparseSignatures/blob/master/vignettes/2_using_the_package.rmd" class="external-link"><code>vignettes/2_using_the_package.rmd</code></a></small>
      <div class="hidden name"><code>2_using_the_package.rmd</code></div>

    </div>

    
    
<p>We now present the main features of the package. To start, we show how to load data and transform them to a count matrix to perform the signatures discovery; first we load some example data provided in the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/danro9685/SparseSignatures" class="external-link">"SparseSignatures"</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: NMF</code></pre>
<pre><code>## Loading required package: pkgmaker</code></pre>
<pre><code>## Loading required package: registry</code></pre>
<pre><code>## Loading required package: rngtools</code></pre>
<pre><code>## Loading required package: cluster</code></pre>
<pre><code>## NMF - BioConductor layer [OK] | Shared memory capabilities [NO: bigmemory] | Cores 2/2</code></pre>
<pre><code>##   To enable shared memory capabilities, try: install.extras('
## NMF
## ')</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ssm560_reduced</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ssm560_reduced</span><span class="op">)</span></code></pre></div>
<pre><code>##      sample chrom     start       end ref alt
## 1: PD10014a     1 186484577 186484577   A   C
## 2: PD10014a     7 141761948 141761948   G   A
## 3: PD10014a     7  71266228  71266228   C   T
## 4: PD10014a     8  82304475  82304475   A   T
## 5: PD10014a     3 191275626 191275626   T   A
## 6: PD10014a     4 135265376 135265376   C   T</code></pre>
<p>These data are a reduced version with only 3 patients of the 560 breast tumors provided by Nik-Zainal, Serena, et al. (2016). We can transform such input data to a count matrix to perform the signatures discovery with the function import.counts.data. To do so, we also need to specify the reference genome as a BSgenome object and the format of the 96 nucleotides to be considered. This can be done as follows, where in the example we use hs37d5 as our reference genome.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"BSgenome.Hsapiens.1000genomes.hs37d5"</span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: BSgenome</code></pre>
<pre><code>## Loading required package: S4Vectors</code></pre>
<pre><code>## Loading required package: stats4</code></pre>
<pre><code>## 
## Attaching package: 'S4Vectors'</code></pre>
<pre><code>## The following object is masked from 'package:NMF':
## 
##     nrun</code></pre>
<pre><code>## The following object is masked from 'package:pkgmaker':
## 
##     new2</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     expand.grid</code></pre>
<pre><code>## Loading required package: IRanges</code></pre>
<pre><code>## Loading required package: GenomeInfoDb</code></pre>
<pre><code>## Loading required package: GenomicRanges</code></pre>
<pre><code>## Loading required package: Biostrings</code></pre>
<pre><code>## Loading required package: XVector</code></pre>
<pre><code>## 
## Attaching package: 'Biostrings'</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     strsplit</code></pre>
<pre><code>## Loading required package: rtracklayer</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bsg</span> <span class="op">=</span> <span class="va">BSgenome.Hsapiens.1000genomes.hs37d5</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mutation_categories</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mutation_categories</span><span class="op">)</span></code></pre></div>
<pre><code>##    context alt     cat
## 1:     A:A C&gt;A A[C&gt;A]A
## 2:     C:A C&gt;A C[C&gt;A]A
## 3:     G:A C&gt;A G[C&gt;A]A
## 4:     T:A C&gt;A T[C&gt;A]A
## 5:     A:A C&gt;G A[C&gt;G]A
## 6:     C:A C&gt;G C[C&gt;G]A</code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">imported_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/import.trinucleotides.counts.html">import.trinucleotides.counts</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">ssm560_reduced</span>,reference<span class="op">=</span><span class="va">bsg</span>,mutation_categories<span class="op">=</span><span class="va">mutation_categories</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">imported_data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">imported_data</span><span class="op">)</span></code></pre></div>
<pre><code>##          A[C&gt;A]A A[C&gt;A]C A[C&gt;A]G A[C&gt;A]T A[C&gt;G]A A[C&gt;G]C A[C&gt;G]G A[C&gt;G]T
## PD10010a      37      25       8      24      35       5      16      25
## PD10011a     103      59      16      73     113      54      31     102
## PD10014a     235     241      37     234     158      71      26     180
##          A[C&gt;T]A A[C&gt;T]C A[C&gt;T]G A[C&gt;T]T A[T&gt;A]A A[T&gt;A]C A[T&gt;A]G A[T&gt;A]T
## PD10010a      49      31     100      42      21      15      17      30
## PD10011a     116      73     228     109      61      70      56     165
## PD10014a     229      89     178     186     105      90     126     174
##          A[T&gt;C]A A[T&gt;C]C A[T&gt;C]G A[T&gt;C]T A[T&gt;G]A A[T&gt;G]C A[T&gt;G]G A[T&gt;G]T
## PD10010a      48      20      29      44       8       6      10      23
## PD10011a     184     116     113     169      77      41      73     105
## PD10014a     261     122     167     211      76      27      84      59
##          C[C&gt;A]A C[C&gt;A]C C[C&gt;A]G C[C&gt;A]T C[C&gt;G]A C[C&gt;G]C C[C&gt;G]G C[C&gt;G]T
## PD10010a      34      28       8      23      15      19      20      26
## PD10011a     105      75      30     102      60      37      22      65
## PD10014a     244     238      35     243     107     105      40     144
##          C[C&gt;T]A C[C&gt;T]C C[C&gt;T]G C[C&gt;T]T C[T&gt;A]A C[T&gt;A]C C[T&gt;A]G C[T&gt;A]T
## PD10010a      48      37      55      43      12       7      18      16
## PD10011a      71      52     108     103     116      80      89     103
## PD10014a     136     124     144     197     116     139     145     217
##          C[T&gt;C]A C[T&gt;C]C C[T&gt;C]G C[T&gt;C]T C[T&gt;G]A C[T&gt;G]C C[T&gt;G]G C[T&gt;G]T
## PD10010a      14      17      20      30       6       8       5      13
## PD10011a     103      78     102     158      40      65      55     188
## PD10014a     103     144     112     129      47      54      70     107
##          G[C&gt;A]A G[C&gt;A]C G[C&gt;A]G G[C&gt;A]T G[C&gt;G]A G[C&gt;G]C G[C&gt;G]G G[C&gt;G]T
## PD10010a      31      22      11      22       6      12       9      14
## PD10011a      78      50      14      55      55      66      13      87
## PD10014a     146     126      24     160      63      70      25     120
##          G[C&gt;T]A G[C&gt;T]C G[C&gt;T]G G[C&gt;T]T G[T&gt;A]A G[T&gt;A]C G[T&gt;A]G G[T&gt;A]T
## PD10010a      40      32      82      25       6       6       6      13
## PD10011a      76      63     118      81      69      41      56      86
## PD10014a     141      99     180     163      62      66      83     126
##          G[T&gt;C]A G[T&gt;C]C G[T&gt;C]G G[T&gt;C]T G[T&gt;G]A G[T&gt;G]C G[T&gt;G]G G[T&gt;G]T
## PD10010a      22       9      16      24       7       1       8      10
## PD10011a      96      62      82      93      56      46      35      99
## PD10014a     110      81     102     135      32      18      61      78
##          T[C&gt;A]A T[C&gt;A]C T[C&gt;A]G T[C&gt;A]T T[C&gt;G]A T[C&gt;G]C T[C&gt;G]G T[C&gt;G]T
## PD10010a      40      40      12      48      54      37      12      85
## PD10011a      78      80      12      83     116     104      29     194
## PD10014a     202     191      17     253     198     159      33     325
##          T[C&gt;T]A T[C&gt;T]C T[C&gt;T]G T[C&gt;T]T T[T&gt;A]A T[T&gt;A]C T[T&gt;A]G T[T&gt;A]T
## PD10010a      67      55      53      71      39      13       3      35
## PD10011a     119      94      78     126     121      43      64      91
## PD10014a     188     153      93     184     124      89      73     221
##          T[T&gt;C]A T[T&gt;C]C T[T&gt;C]G T[T&gt;C]T T[T&gt;G]A T[T&gt;G]C T[T&gt;G]G T[T&gt;G]T
## PD10010a      19      13      11      25      18      11      11      35
## PD10011a     125      79      83     113      68      90     140     251
## PD10014a     143     118      75     148      71      54      76     160</code></pre>
<p>The function import.counts.data can also take a text file as input with the same format as the one shown above. Now, we show an example of a visualization feature provided by the package, and we show the counts for the first patient PD10010a in the following plot.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/patients.plot.html">patients.plot</a></span><span class="op">(</span>trinucleotides_counts<span class="op">=</span><span class="va">imported_data</span>,samples<span class="op">=</span><span class="st">"PD10010a"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="2_using_the_package_files/figure-html/unnamed-chunk-5-1.png" alt="Visualization of the counts from patient PD10010a from the dataset published in Nik-Zainal, Serena, et al." width="672"><p class="caption">
Visualization of the counts from patient PD10010a from the dataset published in Nik-Zainal, Serena, et al.
</p>
</div>
<p>After the data are loaded, signatures can be discovered. To do so, we need to define a set of parameters on which to perform the estimation.</p>
<p>First of all, we need to specify the ranges for the number of signatures (variable K) and the LASSO penalty value (variable lambda rate) to be considered. The latter is more complicated to estimate, as it requires that the values in the range not to be too small in order to avoid dense signatures, but also should not be to high in order to still perform a good fit of the observed counts.</p>
<p>Besides these parameters, we also need to estimate the initial values of beta to be used during the estimation. We now show how to do this on the set of counts from 560 tumors provided in Nik-Zainal, Serena, et al. (2016).</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">patients</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">patients</span><span class="op">)</span></code></pre></div>
<pre><code>##         A[C&gt;A]A A[C&gt;A]C A[C&gt;A]G A[C&gt;A]T A[C&gt;G]A A[C&gt;G]C A[C&gt;G]G A[C&gt;G]T A[C&gt;T]A
## PD8623a      24      23       4      20      10      19       2      11      43
## PD8618a      29      19       2      15      11      12       2       8      31
## PD6418a      23      29       4      26      12       9       1      12      39
## PD7214a      19      20       5      18      11       5       4       7      30
## PD4968a      59      64       5      34      25      16       1      18      81
## PD4954a     102      87      19      82      80      48      13      88     117
##         A[C&gt;T]C A[C&gt;T]G A[C&gt;T]T A[T&gt;A]A A[T&gt;A]C A[T&gt;A]G A[T&gt;A]T A[T&gt;C]A A[T&gt;C]C
## PD8623a      25      77      28      16      12      23      37      57       7
## PD8618a      17      91      24      10      10       8      18      50      23
## PD6418a      36     104      36      13      19      26      22      53      19
## PD7214a      22      65      21      12      18      17      18      41      12
## PD4968a      57     246      70      26      46      53      66      93      39
## PD4954a      53     125      79      64      48      37      52      97      41
##         A[T&gt;C]G A[T&gt;C]T A[T&gt;G]A A[T&gt;G]C A[T&gt;G]G A[T&gt;G]T C[C&gt;A]A C[C&gt;A]C C[C&gt;A]G
## PD8623a      30      42      12       6       8      16      32      21       6
## PD8618a      31      59       1       3       6       7      18      15       3
## PD6418a      32      57       7       4       6       8      24      19       2
## PD7214a      23      43       4       5       3       9      15      13       1
## PD4968a      47      85      17       6       7      16      45      27      10
## PD4954a      64      97      26      11      38      41     100      90      18
##         C[C&gt;A]T C[C&gt;G]A C[C&gt;G]C C[C&gt;G]G C[C&gt;G]T C[C&gt;T]A C[C&gt;T]C C[C&gt;T]G C[C&gt;T]T
## PD8623a      26      13      13       4      19      32      40      73      31
## PD8618a      14       4       9       4       3      21      33      61      30
## PD6418a      23      15      15       4       8      42      36      71      51
## PD7214a      10       7       5       2      12      31      32      48      40
## PD4968a      53      13      15      14      27      82      88     145      79
## PD4954a      83      77      48      22      65      90      64      84      99
##         C[T&gt;A]A C[T&gt;A]C C[T&gt;A]G C[T&gt;A]T C[T&gt;C]A C[T&gt;C]C C[T&gt;C]G C[T&gt;C]T C[T&gt;G]A
## PD8623a      10      10      10      11      14      15      15      23       3
## PD8618a       6       4       7       5      11      17      10      13       4
## PD6418a       6      13       9      14      19       8      13      14       6
## PD7214a       9       4       3       6       8       9       9       8       0
## PD4968a      13      25      20      36      22      24      29      37       7
## PD4954a      41      48      55      57      46      53      40      74      17
##         C[T&gt;G]C C[T&gt;G]G C[T&gt;G]T G[C&gt;A]A G[C&gt;A]C G[C&gt;A]G G[C&gt;A]T G[C&gt;G]A G[C&gt;G]C
## PD8623a       7      14      15      13      20       3      13       9       2
## PD8618a       4       6       5      17      13       9      14       2      10
## PD6418a       8       8      14      20      20       9      16       5       6
## PD7214a       7       8      12      24       7       2       8       6       6
## PD4968a      10       7      24      35      25      12      30       9      13
## PD4954a      19      37      42      53      67      13      42      40      28
##         G[C&gt;G]G G[C&gt;G]T G[C&gt;T]A G[C&gt;T]C G[C&gt;T]G G[C&gt;T]T G[T&gt;A]A G[T&gt;A]C G[T&gt;A]G
## PD8623a       1       6      33      24      61      29       3      11       6
## PD8618a       0       5      23      33      67      29       3      12       4
## PD6418a       3       5      35      39      94      34       7      12       9
## PD7214a       3       4      31      47      50      24       1       8       6
## PD4968a       1      11      68      62     190      65       8      21      14
## PD4954a       1      63      72      69      85      67      19      29      22
##         G[T&gt;A]T G[T&gt;C]A G[T&gt;C]C G[T&gt;C]G G[T&gt;C]T G[T&gt;G]A G[T&gt;G]C G[T&gt;G]G G[T&gt;G]T
## PD8623a       6      15      10       6      23       1       3       5       4
## PD8618a       5      17      10       8      23       0       1       1       0
## PD6418a       8      36      11      22      22       1       3       3       6
## PD7214a       8      26      12       8      18       1       3       2       2
## PD4968a      18      43      19      29      35       6       3       3      11
## PD4954a      49      61      37      34      54      12       7      32      36
##         T[C&gt;A]A T[C&gt;A]C T[C&gt;A]G T[C&gt;A]T T[C&gt;G]A T[C&gt;G]C T[C&gt;G]G T[C&gt;G]T T[C&gt;T]A
## PD8623a      34      24       8      31      22      20       1      32     119
## PD8618a      22      17      10      25      15      14       1      30      47
## PD6418a      34      23       5      35       9      12       2      24      43
## PD7214a      14      22       6      24       9       7       2      24      52
## PD4968a      79      57       9      87      64      27       8     120     464
## PD4954a      92     109      11     106     158      89      17     279     166
##         T[C&gt;T]C T[C&gt;T]G T[C&gt;T]T T[T&gt;A]A T[T&gt;A]C T[T&gt;A]G T[T&gt;A]T T[T&gt;C]A T[T&gt;C]C
## PD8623a      59      52      98      29      15       6      18      25      17
## PD8618a      26      37      37      20       4       3      13      21      12
## PD6418a      56      52      65      31       9       9      15      25      17
## PD7214a      38      41      62      14       8       7      16      19      14
## PD4968a     177     157     337     127      20      19      42      41      42
## PD4954a     114      48     150      62      44      27      71      58      38
##         T[T&gt;C]G T[T&gt;C]T T[T&gt;G]A T[T&gt;G]C T[T&gt;G]G T[T&gt;G]T
## PD8623a      11      26       9      11      10      27
## PD8618a      12      16       4       3       6      11
## PD6418a       9      36       9       6       9      20
## PD7214a      13      22       4      10       8      19
## PD4968a      23      44      15       8      15      38
## PD4954a      30      57      40      29      37      62</code></pre>
<p>First, we can estimate the initial values of beta as follows.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">starting_betas</span> <span class="op">=</span> <span class="fu"><a href="../reference/startingBetaEstimation.html">startingBetaEstimation</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">patients</span>,K<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">12</span>,background_signature<span class="op">=</span><span class="va">background</span><span class="op">)</span></code></pre></div>
<p>Then, we also need to explore the search space of values for the LASSO penalty in order to make a good choice. To do so, we can use the function lambdaRangeBetaEvaluation to test different values to sparsify beta as follows. Notice that the package also provides the option to sparsify alpha and, in this case, we may use the function lambdaRangeAlphaEvaluation to explore the search space of values.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lambda_range</span> <span class="op">=</span> <span class="fu"><a href="../reference/lambdaRangeBetaEvaluation.html">lambdaRangeBetaEvaluation</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">patients</span>,K<span class="op">=</span><span class="fl">10</span>,beta<span class="op">=</span><span class="va">starting_betas</span><span class="op">[[</span><span class="fl">8</span>,<span class="fl">1</span><span class="op">]</span><span class="op">]</span>,
                                         lambda_values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>As the executions of these functions can be very time-consuming, we also provide as examples together with the package a set of pre-computed results by the two functions startingBetaEstimation and lambdaRangeBetaEvaluation obtained with the commands above.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">starting_betas_example</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lambda_range_example</span><span class="op">)</span></code></pre></div>
<p>Now that we have evaluated all the required parameters, we need to decide which configuration of number of signatures and lambda value is the best. To do so, we rely on cross-validation.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cv</span> <span class="op">=</span> <span class="fu"><a href="../reference/nmfLassoCV.html">nmfLassoCV</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">patients</span>,K<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>We notice that the computations for this task can be very time consuming, expecially when many iterations of cross validations are specified (see manual) and a large set of configurations of the parameters are tested. To speed up the execution, we suggest using the parallel execution options. Also, to reduce the memory requirements, we advise splitting the cross validation in different runs, e.g., if one wants to perform 100 iterations, we would suggest making 10 independent runs of 10 iterations each. Also in this case, we provide as examples together with the package a set of pre-computed results obtained with the above command and the following settings: K = 3:10, cross validation entries = 0.10, lambda values = c(0.05,0.10,0.15), number of iterations of cross-validation = 2.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">cv_example</span><span class="op">)</span></code></pre></div>
<p>Finally, we can compute the signatures for the best configuration, i.e., K = 5.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta</span> <span class="op">=</span> <span class="va">starting_betas_example</span><span class="op">[[</span><span class="st">"5_signatures"</span>,<span class="st">"Value"</span><span class="op">]</span><span class="op">]</span>
<span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/nmfLasso.html">nmfLasso</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">patients</span>, K <span class="op">=</span> <span class="fl">5</span>, beta <span class="op">=</span> <span class="va">beta</span>, background_signature <span class="op">=</span> <span class="va">background</span>, seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></code></pre></div>
<pre><code>## Performing the discovery of the signatures by NMF with Lasso... 
## Performing a total of 30 iterations... 
## Progress 3.33333333333333%... 
## Progress 6.66666666666667%... 
## Progress 10%... 
## Progress 13.3333333333333%... 
## Progress 16.6666666666667%... 
## Progress 20%... 
## Progress 23.3333333333333%... 
## Progress 26.6666666666667%... 
## Progress 30%... 
## Progress 33.3333333333333%... 
## Progress 36.6666666666667%... 
## Progress 40%... 
## Progress 43.3333333333333%... 
## Progress 46.6666666666667%... 
## Progress 50%... 
## Progress 53.3333333333333%... 
## Progress 56.6666666666667%... 
## Progress 60%... 
## Progress 63.3333333333333%... 
## Progress 66.6666666666667%... 
## Progress 70%... 
## Progress 73.3333333333333%... 
## Progress 76.6666666666667%... 
## Progress 80%... 
## Progress 83.3333333333333%... 
## Progress 86.6666666666667%... 
## Progress 90%... 
## Progress 93.3333333333333%... 
## Progress 96.6666666666667%... 
## Progress 100%...</code></pre>
<pre><code>## Warning in nmfLassoDecomposition(x, beta, lambda_rate_alpha, lambda_rate_beta, :
## The likelihood is not increasing, you should try a lower value of lambda!
## Current settings: K = 6, lambda_rate_alpha = 0.05, lambda_rate_beta = 0.05...</code></pre>
<p>We conclude this vignette by plotting the discovered signatures.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">nmf_LassoK_example</span><span class="op">)</span>
<span class="va">signatures</span> <span class="op">=</span> <span class="va">nmf_LassoK_example</span><span class="op">$</span><span class="va">beta</span>
<span class="fu"><a href="../reference/signatures.plot.html">signatures.plot</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">signatures</span>, xlabels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="2_using_the_package_files/figure-html/unnamed-chunk-13-1.png" alt="Visualization of the discovered signatures." width="672"><p class="caption">
Visualization of the discovered signatures.
</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Daniele Ramazzotti, Avantika Lal, Luca De Sano, Arend Sidow.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
